"use strict";$(function(){var t=$("figure"),u=$("#light-box");function p(){$("html").css({overflow:"hidden"})}function e(){$(window).off("resize"),$("html").css({overflow:"auto"})}u.on("click",function(){u.off("mousemove").hide(0,e)}),t.find("img").on("click touchstart",function(t){t.preventDefault();function e(t){var e="zoom-out";r.update(),n?(u.on("touchstart",l),u.on("touchmove",c),d()):r.needsToPan?(e="move",u.on("mousemove",s)):u.off("mousemove",s),n||(s(t),f.css("cursor",e))}function a(t){var e=0,i=0,o=t.targetTouches;return void 0!==o&&(e=o[0].clientX,i=o[0].clientY),[e,i]}var i=$(this),f=u.find("img"),o=i.data("big-loaded"),n="touchstart"==t.type,r=new g(i.data("big-width"),i.data("big-height")),h={top:0,left:0},s=function(t){var e=t.clientX,i=t.clientY;if(void 0!==e&&void 0!==i){var o=r.width.offset(e),n=r.height.offset(i);f.css({transform:"translate("+o+"px, "+n+"px)"})}},d=function(){var t=r.width.center(),e=r.height.center();f.css({transform:"translate("+t+"px, "+e+"px)"})},l=function(t){var e=f.position(),i=a(t),o=i[0],n=i[1];h.left=e.left-o,h.top=e.top-n},c=function(t){var e=a(t),i=e[0],o=e[1],n=h.left+i,r=h.top+o;f.css({transform:"translate("+n+"px, "+r+"px)"})};void 0===o&&(o=!1);o?f.attr("src",i.data("big")):(f.attr("src",i.data("original")),$("<img />").bind("load",function(){f.attr("src",this.src),i.data("big-loaded",!0)}).attr("src",i.data("big")));f.height(r.height.image).width(r.width.image),e(t),u.show(0,p),$(window).resize(e)}).lazyload(),t.find(".info-button").one("mouseover",function(){var t=$(this);t.addClass("loading").html(function(t,e){return util.html.icon(t).get(0).outerHTML+"<p>"+e+"</p>"}("cloud_download","Loading â€¦")).load(t.parent().data("exif"),function(){t.removeClass("loading").addClass("loaded")})});var i=(o.prototype.update=function(t){this.window=t,this.extra=(this.window-this.image)/2},o.prototype.ratio=function(){return(this.window-this.image)/this.window*2},o.prototype.offset=function(t){var e=0<this.extra?0:(this.window/2-t)*this.panRatio;return this.extra-e},o.prototype.center=function(){return this.extra/2},o);function o(t){this.image=parseInt(t),this.window=0,this.extra=0,this.panRatio=0}var g=(n.prototype.update=function(){this.height.update(window.innerHeight),this.width.update(window.innerWidth),this.needsToPan=this.width.extra<0||this.height.extra<0,this.needsToPan&&(this.height.panRatio=this.width.panRatio=this.width.extra<this.height.extra&&this.width.extra<0?this.width.ratio():this.height.ratio())},n);function n(t,e){this.width=new i(t),this.height=new i(e)}}),$(function(){$(".static-map").each(function(t,e){var i=$(e),o=i.data("locations"),n=i.data("href");if(o&&n&&0<o.length){var r=o.map(function(t){return"url-"+encodeURIComponent("https://www.trailimage.com/p.png("+t[0]+","+t[1]+")")});i.attr("src",n.replace("-pins-",r.join(",")))}})}),function(f,o,n,h){var s=f(o);f.fn.lazyload=function(t){var e,r=this,a={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:o,data_attribute:"original",skip_invisible:!1,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};function i(){var e=0;r.each(function(){var t=f(this);if(!a.skip_invisible||t.is(":visible"))if(f.abovethetop(this,a)||f.leftofbegin(this,a));else if(f.belowthefold(this,a)||f.rightoffold(this,a)){if(++e>a.failure_limit)return!1}else t.trigger("appear"),e=0})}return t&&(h!==t.failurelimit&&(t.failure_limit=t.failurelimit,delete t.failurelimit),h!==t.effectspeed&&(t.effect_speed=t.effectspeed,delete t.effectspeed),f.extend(a,t)),e=a.container===h||a.container===o?s:f(a.container),0===a.event.indexOf("scroll")&&e.bind(a.event,function(){return i()}),this.each(function(){var o=this,n=f(o);o.loaded=!1,n.attr("src")!==h&&!1!==n.attr("src")||n.is("img")&&n.attr("src",a.placeholder),n.one("appear",function(){if(!this.loaded){if(a.appear){var t=r.length;a.appear.call(o,t,a)}f("<img />").bind("load",function(){var t=n.attr("data-"+a.data_attribute);n.hide(),n.is("img")?n.attr("src",t):n.css("background-image","url('"+t+"')"),n[a.effect](a.effect_speed),o.loaded=!0;var e=f.grep(r,function(t){return!t.loaded});if(r=f(e),a.load){var i=r.length;a.load.call(o,i,a)}}).attr("src",n.attr("data-"+a.data_attribute))}}),0!==a.event.indexOf("scroll")&&n.bind(a.event,function(){o.loaded||n.trigger("appear")})}),s.bind("resize",function(){i()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&s.bind("pageshow",function(t){t.originalEvent&&t.originalEvent.persisted&&r.each(function(){f(this).trigger("appear")})}),f(n).ready(function(){i()}),this},f.belowthefold=function(t,e){return(e.container===h||e.container===o?(o.innerHeight?o.innerHeight:s.height())+s.scrollTop():f(e.container).offset().top+f(e.container).height())<=f(t).offset().top-e.threshold},f.rightoffold=function(t,e){return(e.container===h||e.container===o?s.width()+s.scrollLeft():f(e.container).offset().left+f(e.container).width())<=f(t).offset().left-e.threshold},f.abovethetop=function(t,e){return(e.container===h||e.container===o?s.scrollTop():f(e.container).offset().top)>=f(t).offset().top+e.threshold+f(t).height()},f.leftofbegin=function(t,e){return(e.container===h||e.container===o?s.scrollLeft():f(e.container).offset().left)>=f(t).offset().left+e.threshold+f(t).width()},f.inviewport=function(t,e){return!(f.rightoffold(t,e)||f.leftofbegin(t,e)||f.belowthefold(t,e)||f.abovethetop(t,e))},f.extend(f.expr[":"],{"below-the-fold":function(t){return f.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!f.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return f.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!f.rightoffold(t,{threshold:0})},"in-viewport":function(t){return f.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!f.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return f.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!f.rightoffold(t,{threshold:0})}})}(jQuery,window,document);
//# sourceMappingURL=/js/maps/post.js.map
