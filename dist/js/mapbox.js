"use strict";$(function(){function o(o){o==i||!o&&a||(i=o,i?(f.on.show(),f.off.hide()):(f.on.hide(),f.off.show()),m.once("data",function(o){"style"==o.dataType&&c()}),m.setStyle("mapbox://styles/"+(i?r.imagery:r.basic)))}function t(){m.getZoom()>l.zoom&&!v?(v=!0,d.click(function(){m.easeTo(l)}).removeClass("disabled")):m.getZoom()<=l.zoom&&v&&(v=!1,d.off("click").addClass("disabled"))}function e(o){return void 0===o&&(o=""),function(){g.style.cursor=o}}function n(o){var t=o.split("/"),e=t[t.length-1].split("_");window.location="/"+e[0]}function c(){m.addSource("photos",{type:"geojson",data:b,cluster:!0,clusterMaxZoom:15,clusterRadius:20}),m.addLayer({id:"cluster",type:"circle",source:"photos",filter:["has","point_count"],paint:{"circle-color":"#524948","circle-radius":{property:"point_count",type:"interval",stops:[[0,13],[50,17],[100,20]]},"circle-opacity":y,"circle-stroke-width":3,"circle-stroke-color":"#ccc"}}),m.addLayer({id:"cluster-count",type:"symbol",source:"photos",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":14},paint:{"text-color":"#fff"}}),m.addLayer({id:"photo",type:"circle",source:"photos",filter:["!has","point_count"],paint:{"circle-color":"#f00","circle-radius":7,"circle-stroke-width":4,"circle-stroke-color":"#fdd","circle-opacity":y}}),m.on("mouseenter","cluster",e("pointer")).on("mouseleave","cluster",e()).on("mouseenter","photo",e("pointer")).on("mouseleave","photo",e()).on("move",function(){p.hide()}).on("click",function(){p.hide()}).on("zoomend",function(){t()}),m.on("mousedown","cluster",function(o){m.easeTo({center:o.lngLat,zoom:m.getZoom()+2})}),m.on("mousedown","photo",function(o){var t=o.features[0].properties;p.empty().append($("<img>").attr("src",t.url)).append($("<div>").html(o.lngLat.lat+", "+o.lngLat.lng)).css({top:o.point.y,left:o.point.x}).click(function(){n(t.url)}).show()})}var i=!1,a=!1,l={zoom:6.5,center:[-116.0987,44.7]},r={basic:"jabbott7/cj1k069f0000p2slh5775akgj",imagery:"mapbox/satellite-streets-v9"},s=$("#photo-count"),p=$("#photo-preview"),u=$("#toggle-satellite"),d=$("#zoom-out"),f={on:$("nav .glyphicon-check"),off:$("nav .glyphicon-unchecked")},h=new mapboxgl.NavigationControl,m=new mapboxgl.Map({container:"map-canvas",style:"mapbox://styles/"+r.basic,center:l.center,zoom:l.zoom,dragRotate:!1}),g=m.getCanvasContainer(),y=.6,v=!1,b=null;m.addControl(h,"top-right").on("load",function(){u.click(function(){a=!a,o(a)}),$.getJSON("/geo.json",function(o){b=o,s.html(b.features.length+" photos").show(),c()})})});
//# sourceMappingURL=/js/maps/mapbox.js.map
