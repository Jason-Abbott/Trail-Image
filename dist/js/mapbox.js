"use strict";$(function(){function o(o){var t=Math.pow(10,r),e=function(o){return Math.round(o*t)/t};return e(o.lat)+", "+e(o.lng)}function t(o){o!=a&&(a=o,a?(h.on.show(),h.off.hide()):(h.on.hide(),h.off.show()),y.once("data",function(o){"style"==o.dataType&&i()}),y.setStyle("mapbox://styles/"+(a?s.imagery:s.basic)))}function e(){y.getZoom()>l.zoom&&!b?(b=!0,f.click(function(){y.easeTo(l)}).removeClass("disabled")):y.getZoom()<=l.zoom&&b&&(b=!1,f.off("click").addClass("disabled"))}function n(o){return void 0===o&&(o=""),function(){g.style.cursor=o}}function c(o){var t=o.split("/"),e=t[t.length-1].split("_");window.location="/"+e[0]}function i(){y.addSource("photos",{type:"geojson",data:w,cluster:!0,clusterMaxZoom:22,clusterRadius:20}),y.addLayer({id:"cluster",type:"circle",source:"photos",filter:["has","point_count"],paint:{"circle-color":"#524948","circle-radius":{property:"point_count",type:"interval",stops:[[0,13],[50,17],[100,20]]},"circle-opacity":v,"circle-stroke-width":3,"circle-stroke-color":"#ccc"}}),y.addLayer({id:"cluster-count",type:"symbol",source:"photos",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":14},paint:{"text-color":"#fff"}}),y.addLayer({id:"photo",type:"circle",source:"photos",filter:["!has","point_count"],paint:{"circle-color":"#f00","circle-radius":7,"circle-stroke-width":4,"circle-stroke-color":"#fdd","circle-opacity":v}}),y.on("mouseenter","cluster",n("pointer")).on("mouseleave","cluster",n()).on("mouseenter","photo",n("pointer")).on("mouseleave","photo",n()).on("move",function(){p.hide()}).on("click",function(){p.hide()}).on("zoomend",e),y.on("mousedown","cluster",function(o){y.easeTo({center:o.lngLat,zoom:y.getZoom()+2})}),y.on("mousedown","photo",function(t){var e=t.features[0].properties;p.empty().append($("<img>").attr("src",e.url)).append($("<div>").html(o(t.lngLat))).css({top:t.point.y,left:t.point.x}).click(function(){c(e.url)}).show()})}var r=5,a=!1,l={zoom:6.5,center:[-116.0987,44.7]},s={basic:"jabbott7/cj1k069f0000p2slh5775akgj",imagery:"mapbox/satellite-streets-v9"},u=$("#photo-count"),p=$("#photo-preview"),d=$("#toggle-satellite"),f=$("#zoom-out"),h={on:$("nav .glyphicon-check"),off:$("nav .glyphicon-unchecked")},m=new mapboxgl.NavigationControl,y=new mapboxgl.Map({container:"map-canvas",style:"mapbox://styles/"+s.basic,center:l.center,zoom:l.zoom,maxZoom:18,dragRotate:!1}),g=y.getCanvasContainer(),v=.6,b=!1,w=null;y.addControl(m,"top-right").on("load",function(){d.click(function(){t(!a)}),$.getJSON("/geo.json",function(o){w=o,u.html(w.features.length+" photos").show(),i()})})});
//# sourceMappingURL=/js/maps/mapbox.js.map
