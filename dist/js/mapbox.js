"use strict";$(function(){function t(t){return void 0===t&&(t=""),function(){s.style.cursor=t}}function o(t){var o=t.split("/"),e=o[o.length-1].split("_");window.location="/"+e[0]}function e(){a.addSource("photos",{type:"geojson",data:u,cluster:!0,clusterMaxZoom:15,clusterRadius:20}),a.addLayer({id:"cluster",type:"circle",source:"photos",filter:["has","point_count"],paint:{"circle-color":"#524948","circle-radius":{property:"point_count",type:"interval",stops:[[0,13],[50,17],[100,20]]},"circle-opacity":p,"circle-stroke-width":3,"circle-stroke-color":"#ccc"}}),a.addLayer({id:"cluster-count",type:"symbol",source:"photos",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":14},paint:{"text-color":"#fff"}}),a.addLayer({id:"photo",type:"circle",source:"photos",filter:["!has","point_count"],paint:{"circle-color":"#f00","circle-radius":7,"circle-stroke-width":4,"circle-stroke-color":"#fdd","circle-opacity":p}}),a.on("mouseenter","cluster",t("pointer")).on("mouseleave","cluster",t()).on("mouseenter","photo",t("pointer")).on("mouseleave","photo",t()).on("move",function(){r.hide()}).on("click",function(){r.hide()}),a.on("mousedown","cluster",function(t){t.features[0].properties.point_count>5?a.easeTo({center:t.lngLat,zoom:a.getZoom()+2}):(new mapboxgl.LngLatBounds(t.lngLat,t.lngLat),console.log(a.getSource("photos")))}),a.on("mousedown","photo",function(t){var e=t.features[0].properties;r.empty().append($("<img>").attr("src",e.url)).append($("<div>").html(t.lngLat.lat+", "+t.lngLat.lng)).css({top:t.point.y,left:t.point.x}).click(function(){o(e.url)}).show()})}var n=!1,c={street:"streets-v9",imagery:"satellite-streets-v9"},r=$("#photo-preview"),i=$("#toggle-satellite"),l=new mapboxgl.NavigationControl,a=new mapboxgl.Map({container:"map-canvas",style:"mapbox://styles/mapbox/streets-v9",center:[-116.0987,44.7],zoom:6.5,dragRotate:!1}),s=a.getCanvasContainer(),p=.6,u=null;a.addControl(l,"top-right").on("load",function(){i.click(function(){n=!n,a.once("data",function(t){"style"==t.dataType&&e()}).setStyle("mapbox://styles/mapbox/"+(n?c.imagery:c.street))}),$.getJSON("/geo.json",function(t){u=t,e()})})});
//# sourceMappingURL=/js/maps/mapbox.js.map
